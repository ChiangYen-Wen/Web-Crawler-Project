# 基礎工程 - 爬蟲程式碼介紹
> **本專案共有三種程式碼，分述如下:**
> 
>> **009803 ETF 報價資料爬蟲程式碼**
>>
>> **TWSE 流通在外股數爬蟲程式碼**
>>
>> **法務部機構法人洗錢防制公告資料爬蟲確認**
>> 

## 📊 009803 ETF 報價資料爬蟲程式碼
### 使用Playwright建構的自動化爬蟲
### 自動化登入並下載ETF報價檔案（如 MA1、MA2、MA3、MA5），並協助通路商進行造市商評分
### 後續轉成.exe檔案，並排程每日自動執行

#### 🚀 專案特色
> ✅ 自動化登入（含已登入時的強制登入機制）。
> 
> 🧱 處理多層 iframe 結構，穩定抓取資料。
> 
> 🕟 自動排成每日定時執行減少人工作業。
> 
> 📝 每一步皆可選擇儲存 HTML 以利未來除錯。

#### 🔧 關鍵套件（技術介紹）
> playwright：核心套件，模擬瀏覽器操作，處理 iframe、點擊、下載等互動式元素。
>
> asyncio：配合 Playwright 非同步結構，提高爬蟲效率與穩定性。
>
> pyinstaller：將爬蟲打包成獨立的 .exe 可執行檔，方便移轉位置與排程執行。
>

#### 💡 為什麼使用 Playwright 而不是 requests？
> 🎯 網站特性：非純靜態網頁，需完整模擬瀏覽器行為。
> 
> 🔄 能夠保持登入、動態處理 iframe架構與上下兩層的互動式選單。
> 
> 🧠 程式邏輯更貼近「實際使用者操作」，可穩定運作，且能避免網站阻擋。

#### 👨‍💻 兩者差異 : requests 是「郵差」，Playwright 是「模仿你本人在電腦上操作」
> requests 適合處理「用表單送資料給伺服器」的簡單靜態網站。
> 
> Playwright 像是「開啟瀏覽器模擬，且真的點每個按鈕」，能處理動態頁面與 JavaScript、iframe、下載等複雜行為。

#### 📁第二份程式碼為編譯.dat檔案，轉譯成並寫入Access資料庫內，以及產出個別Excel檔案。

---

## 📊 TWSE 流通在外股數爬蟲程式碼
### 使用 requests + BeautifulSoup 建構的自動化爬蟲
### 自動送出 POST 請求至 MOPS（公開資訊觀測站），爬取指定股票的歷年流通在外股數資料
### 爬取的股數資料詳細到"個位數"，可用於編列內部基準指數，更嚴謹判斷市場狀況。

#### 🚀 專案特色
> ✅ 使用 POST 表單請求模擬實際查詢表單，支援查詢特定股票編號的流通股數資料。
>
> 📄 將查詢結果解析為 HTML 表格並轉為 DataFrame，利於後續處理與分析。
>
> 🔁 可迴圈處理多筆股票代碼，自動等待與隨機 sleep 模擬人為操作，降低封鎖風險。
>
> 🧹 將多個查詢結果合併為單一資料表，便於 Excel 匯出與數據彙整。

#### 🔧 使用技術與邏輯架構
> 💻 關鍵套件
> requests：模擬瀏覽器發送 POST 表單。
>  
> BeautifulSoup：解析 HTML 頁面結構並擷取資料。
>  
> pandas：結構化資料並進行整併與輸出。

#### 📬 為什麼用 requests 而不是 Playwright？
> 因為這個目標網站（MOPS）屬於「傳統表單查詢式頁面」。
>
> 直接透過 requests.post() 傳送查詢條件即可，不需模擬瀏覽器行為。
>
> 比起 Playwright，requests 在這樣的操作方式會更快、更穩定。

#### 📁 整合所有股票查詢結果後輸出成 Excel，可做為後續分析或入庫使用。

-----

## 📊 法務部機構法人洗錢防制公告資料爬蟲
### 鎖定 AML（洗錢防制）公開揭露平台，自動化擷取法人與機構公告資訊連結。
### 快速收集來自法務部網站上數百則公告文章頁面連結
### 搭配進一步OCR文字分析與關鍵字判讀，用於風控、自動建檔、機構法人關鍵字辨別。

#### 🚀 專案特色
> 📍 自動擷取公告文章連結，並下載PDF檔案。
>
> 🧠 自動分析PDF檔案，並提報出關鍵字，查看是否有"臺灣"等關鍵字。
>
> 💾 支援自動命名並儲存各篇公告內容至指定資料夾，做進行資訊分析與儲存。
>
> 🎛️ 可擴展性強，未來可整合 NLP 分析公告內容情緒或關鍵字。
>
> 🧭 未來可排程每日執行，有需要時每日發信通告相關部門。

#### 🔧 技術簡介
> requests：用於快速抓取頁面內容
>
> BeautifulSoup：解析 HTML，聚焦特定結構（如 section.lp > a）
>
> os：自動儲存 HTML 或純文字內容。
>
> time：加隨機延遲，模擬人為操作，避免觸發封鎖。

#### 💡 特別亮點：
> 這份爬蟲的強項不在資料量，而在「穩定性」與「精準性」。
>
> 很多政府網站常因 iframe、JS 延遲載入、HTML 結構混亂而導致爬蟲失敗，
>
> 但此程式碼能夠解析section結構，穩定性較高且維護成本低。
> 
