# åŸºç¤Žå·¥ç¨‹ - çˆ¬èŸ²ç¨‹å¼ç¢¼ä»‹ç´¹
> **æœ¬å°ˆæ¡ˆå…±æœ‰ä¸‰ç¨®ç¨‹å¼ç¢¼ï¼Œåˆ†è¿°å¦‚ä¸‹:**
> 
>> **009803 ETF å ±åƒ¹è³‡æ–™çˆ¬èŸ²ç¨‹å¼ç¢¼**
>>
>> **TWSE æµé€šåœ¨å¤–è‚¡æ•¸çˆ¬èŸ²ç¨‹å¼ç¢¼**
>>
>> **æ³•å‹™éƒ¨æ©Ÿæ§‹æ³•äººæ´—éŒ¢é˜²åˆ¶å…¬å‘Šè³‡æ–™çˆ¬èŸ²ç¢ºèª**
>> 

## ðŸ“Š 009803 ETF å ±åƒ¹è³‡æ–™çˆ¬èŸ²ç¨‹å¼ç¢¼
### ä½¿ç”¨Playwrightå»ºæ§‹çš„è‡ªå‹•åŒ–çˆ¬èŸ²
### è‡ªå‹•åŒ–ç™»å…¥ä¸¦ä¸‹è¼‰ETFå ±åƒ¹æª”æ¡ˆï¼ˆå¦‚ MA1ã€MA2ã€MA3ã€MA5ï¼‰ï¼Œä¸¦å”åŠ©é€šè·¯å•†é€²è¡Œé€ å¸‚å•†è©•åˆ†
### å¾ŒçºŒè½‰æˆ.exeæª”æ¡ˆï¼Œä¸¦æŽ’ç¨‹æ¯æ—¥è‡ªå‹•åŸ·è¡Œ

#### ðŸš€ å°ˆæ¡ˆç‰¹è‰²
> âœ… è‡ªå‹•åŒ–ç™»å…¥ï¼ˆå«å·²ç™»å…¥æ™‚çš„å¼·åˆ¶ç™»å…¥æ©Ÿåˆ¶ï¼‰ã€‚
> 
> ðŸ§± è™•ç†å¤šå±¤ iframe çµæ§‹ï¼Œç©©å®šæŠ“å–è³‡æ–™ã€‚
> 
> ðŸ•Ÿ è‡ªå‹•æŽ’æˆæ¯æ—¥å®šæ™‚åŸ·è¡Œæ¸›å°‘äººå·¥ä½œæ¥­ã€‚
> 
> ðŸ“ æ¯ä¸€æ­¥çš†å¯é¸æ“‡å„²å­˜ HTML ä»¥åˆ©æœªä¾†é™¤éŒ¯ã€‚

#### ðŸ”§ é—œéµå¥—ä»¶ï¼ˆæŠ€è¡“ä»‹ç´¹ï¼‰
> playwrightï¼šæ ¸å¿ƒå¥—ä»¶ï¼Œæ¨¡æ“¬ç€è¦½å™¨æ“ä½œï¼Œè™•ç† iframeã€é»žæ“Šã€ä¸‹è¼‰ç­‰äº’å‹•å¼å…ƒç´ ã€‚
>
> asyncioï¼šé…åˆ Playwright éžåŒæ­¥çµæ§‹ï¼Œæé«˜çˆ¬èŸ²æ•ˆçŽ‡èˆ‡ç©©å®šæ€§ã€‚
>
> pyinstallerï¼šå°‡çˆ¬èŸ²æ‰“åŒ…æˆç¨ç«‹çš„ .exe å¯åŸ·è¡Œæª”ï¼Œæ–¹ä¾¿ç§»è½‰ä½ç½®èˆ‡æŽ’ç¨‹åŸ·è¡Œã€‚
>

#### ðŸ’¡ ç‚ºä»€éº¼ä½¿ç”¨ Playwright è€Œä¸æ˜¯ requestsï¼Ÿ
> ðŸŽ¯ ç¶²ç«™ç‰¹æ€§ï¼šéžç´”éœæ…‹ç¶²é ï¼Œéœ€å®Œæ•´æ¨¡æ“¬ç€è¦½å™¨è¡Œç‚ºã€‚
> 
> ðŸ”„ èƒ½å¤ ä¿æŒç™»å…¥ã€å‹•æ…‹è™•ç† iframeæž¶æ§‹èˆ‡ä¸Šä¸‹å…©å±¤çš„äº’å‹•å¼é¸å–®ã€‚
> 
> ðŸ§  ç¨‹å¼é‚è¼¯æ›´è²¼è¿‘ã€Œå¯¦éš›ä½¿ç”¨è€…æ“ä½œã€ï¼Œå¯ç©©å®šé‹ä½œï¼Œä¸”èƒ½é¿å…ç¶²ç«™é˜»æ“‹ã€‚

#### ðŸ‘¨â€ðŸ’» å…©è€…å·®ç•° : requests æ˜¯ã€Œéƒµå·®ã€ï¼ŒPlaywright æ˜¯ã€Œæ¨¡ä»¿ä½ æœ¬äººåœ¨é›»è…¦ä¸Šæ“ä½œã€
> requests é©åˆè™•ç†ã€Œç”¨è¡¨å–®é€è³‡æ–™çµ¦ä¼ºæœå™¨ã€çš„ç°¡å–®éœæ…‹ç¶²ç«™ã€‚
> 
> Playwright åƒæ˜¯ã€Œé–‹å•Ÿç€è¦½å™¨æ¨¡æ“¬ï¼Œä¸”çœŸçš„é»žæ¯å€‹æŒ‰éˆ•ã€ï¼Œèƒ½è™•ç†å‹•æ…‹é é¢èˆ‡ JavaScriptã€iframeã€ä¸‹è¼‰ç­‰è¤‡é›œè¡Œç‚ºã€‚

#### ðŸ“ç¬¬äºŒä»½ç¨‹å¼ç¢¼ç‚ºç·¨è­¯.datæª”æ¡ˆï¼Œè½‰è­¯æˆä¸¦å¯«å…¥Accessè³‡æ–™åº«å…§ï¼Œä»¥åŠç”¢å‡ºå€‹åˆ¥Excelæª”æ¡ˆã€‚

---

## ðŸ“Š TWSE æµé€šåœ¨å¤–è‚¡æ•¸çˆ¬èŸ²ç¨‹å¼ç¢¼
### ä½¿ç”¨ requests + BeautifulSoup å»ºæ§‹çš„è‡ªå‹•åŒ–çˆ¬èŸ²
### è‡ªå‹•é€å‡º POST è«‹æ±‚è‡³ MOPSï¼ˆå…¬é–‹è³‡è¨Šè§€æ¸¬ç«™ï¼‰ï¼Œçˆ¬å–æŒ‡å®šè‚¡ç¥¨çš„æ­·å¹´æµé€šåœ¨å¤–è‚¡æ•¸è³‡æ–™
### çˆ¬å–çš„è‚¡æ•¸è³‡æ–™è©³ç´°åˆ°"å€‹ä½æ•¸"ï¼Œå¯ç”¨æ–¼ç·¨åˆ—å…§éƒ¨åŸºæº–æŒ‡æ•¸ï¼Œæ›´åš´è¬¹åˆ¤æ–·å¸‚å ´ç‹€æ³ã€‚

#### ðŸš€ å°ˆæ¡ˆç‰¹è‰²
> âœ… ä½¿ç”¨ POST è¡¨å–®è«‹æ±‚æ¨¡æ“¬å¯¦éš›æŸ¥è©¢è¡¨å–®ï¼Œæ”¯æ´æŸ¥è©¢ç‰¹å®šè‚¡ç¥¨ç·¨è™Ÿçš„æµé€šè‚¡æ•¸è³‡æ–™ã€‚
>
> ðŸ“„ å°‡æŸ¥è©¢çµæžœè§£æžç‚º HTML è¡¨æ ¼ä¸¦è½‰ç‚º DataFrameï¼Œåˆ©æ–¼å¾ŒçºŒè™•ç†èˆ‡åˆ†æžã€‚
>
> ðŸ” å¯è¿´åœˆè™•ç†å¤šç­†è‚¡ç¥¨ä»£ç¢¼ï¼Œè‡ªå‹•ç­‰å¾…èˆ‡éš¨æ©Ÿ sleep æ¨¡æ“¬äººç‚ºæ“ä½œï¼Œé™ä½Žå°éŽ–é¢¨éšªã€‚
>
> ðŸ§¹ å°‡å¤šå€‹æŸ¥è©¢çµæžœåˆä½µç‚ºå–®ä¸€è³‡æ–™è¡¨ï¼Œä¾¿æ–¼ Excel åŒ¯å‡ºèˆ‡æ•¸æ“šå½™æ•´ã€‚

#### ðŸ”§ ä½¿ç”¨æŠ€è¡“èˆ‡é‚è¼¯æž¶æ§‹
> ðŸ’» é—œéµå¥—ä»¶
> requestsï¼šæ¨¡æ“¬ç€è¦½å™¨ç™¼é€ POST è¡¨å–®ã€‚
>  
> BeautifulSoupï¼šè§£æž HTML é é¢çµæ§‹ä¸¦æ“·å–è³‡æ–™ã€‚
>  
> pandasï¼šçµæ§‹åŒ–è³‡æ–™ä¸¦é€²è¡Œæ•´ä½µèˆ‡è¼¸å‡ºã€‚

#### ðŸ“¬ ç‚ºä»€éº¼ç”¨ requests è€Œä¸æ˜¯ Playwrightï¼Ÿ
> å› ç‚ºé€™å€‹ç›®æ¨™ç¶²ç«™ï¼ˆMOPSï¼‰å±¬æ–¼ã€Œå‚³çµ±è¡¨å–®æŸ¥è©¢å¼é é¢ã€ã€‚
>
> ç›´æŽ¥é€éŽ requests.post() å‚³é€æŸ¥è©¢æ¢ä»¶å³å¯ï¼Œä¸éœ€æ¨¡æ“¬ç€è¦½å™¨è¡Œç‚ºã€‚
>
> æ¯”èµ· Playwrightï¼Œrequests åœ¨é€™æ¨£çš„æ“ä½œæ–¹å¼æœƒæ›´å¿«ã€æ›´ç©©å®šã€‚

#### ðŸ“ æ•´åˆæ‰€æœ‰è‚¡ç¥¨æŸ¥è©¢çµæžœå¾Œè¼¸å‡ºæˆ Excelï¼Œå¯åšç‚ºå¾ŒçºŒåˆ†æžæˆ–å…¥åº«ä½¿ç”¨ã€‚

-----

## ðŸ“Š æ³•å‹™éƒ¨æ©Ÿæ§‹æ³•äººæ´—éŒ¢é˜²åˆ¶å…¬å‘Šè³‡æ–™çˆ¬èŸ²
### éŽ–å®š AMLï¼ˆæ´—éŒ¢é˜²åˆ¶ï¼‰å…¬é–‹æ­éœ²å¹³å°ï¼Œè‡ªå‹•åŒ–æ“·å–æ³•äººèˆ‡æ©Ÿæ§‹å…¬å‘Šè³‡è¨Šé€£çµã€‚
### å¿«é€Ÿæ”¶é›†ä¾†è‡ªæ³•å‹™éƒ¨ç¶²ç«™ä¸Šæ•¸ç™¾å‰‡å…¬å‘Šæ–‡ç« é é¢é€£çµ
### æ­é…é€²ä¸€æ­¥OCRæ–‡å­—åˆ†æžèˆ‡é—œéµå­—åˆ¤è®€ï¼Œç”¨æ–¼é¢¨æŽ§ã€è‡ªå‹•å»ºæª”ã€æ©Ÿæ§‹æ³•äººé—œéµå­—è¾¨åˆ¥ã€‚

#### ðŸš€ å°ˆæ¡ˆç‰¹è‰²
> ðŸ“ è‡ªå‹•æ“·å–å…¬å‘Šæ–‡ç« é€£çµï¼Œä¸¦ä¸‹è¼‰PDFæª”æ¡ˆã€‚
>
> ðŸ§  è‡ªå‹•åˆ†æžPDFæª”æ¡ˆï¼Œä¸¦æå ±å‡ºé—œéµå­—ï¼ŒæŸ¥çœ‹æ˜¯å¦æœ‰"è‡ºç£"ç­‰é—œéµå­—ã€‚
>
> ðŸ’¾ æ”¯æ´è‡ªå‹•å‘½åä¸¦å„²å­˜å„ç¯‡å…¬å‘Šå…§å®¹è‡³æŒ‡å®šè³‡æ–™å¤¾ï¼Œåšé€²è¡Œè³‡è¨Šåˆ†æžèˆ‡å„²å­˜ã€‚
>
> ðŸŽ›ï¸ å¯æ“´å±•æ€§å¼·ï¼Œæœªä¾†å¯æ•´åˆ NLP åˆ†æžå…¬å‘Šå…§å®¹æƒ…ç·’æˆ–é—œéµå­—ã€‚
>
> ðŸ§­ æœªä¾†å¯æŽ’ç¨‹æ¯æ—¥åŸ·è¡Œï¼Œæœ‰éœ€è¦æ™‚æ¯æ—¥ç™¼ä¿¡é€šå‘Šç›¸é—œéƒ¨é–€ã€‚

#### ðŸ”§ æŠ€è¡“ç°¡ä»‹
> requestsï¼šç”¨æ–¼å¿«é€ŸæŠ“å–é é¢å…§å®¹
>
> BeautifulSoupï¼šè§£æž HTMLï¼Œèšç„¦ç‰¹å®šçµæ§‹ï¼ˆå¦‚ section.lp > aï¼‰
>
> osï¼šè‡ªå‹•å„²å­˜ HTML æˆ–ç´”æ–‡å­—å…§å®¹ã€‚
>
> timeï¼šåŠ éš¨æ©Ÿå»¶é²ï¼Œæ¨¡æ“¬äººç‚ºæ“ä½œï¼Œé¿å…è§¸ç™¼å°éŽ–ã€‚

#### ðŸ’¡ ç‰¹åˆ¥äº®é»žï¼š
> é€™ä»½çˆ¬èŸ²çš„å¼·é …ä¸åœ¨è³‡æ–™é‡ï¼Œè€Œåœ¨ã€Œç©©å®šæ€§ã€èˆ‡ã€Œç²¾æº–æ€§ã€ã€‚
>
> å¾ˆå¤šæ”¿åºœç¶²ç«™å¸¸å›  iframeã€JS å»¶é²è¼‰å…¥ã€HTML çµæ§‹æ··äº‚è€Œå°Žè‡´çˆ¬èŸ²å¤±æ•—ï¼Œ
>
> ä½†æ­¤ç¨‹å¼ç¢¼èƒ½å¤ è§£æžsectionçµæ§‹ï¼Œç©©å®šæ€§è¼ƒé«˜ä¸”ç¶­è­·æˆæœ¬ä½Žã€‚
> 
